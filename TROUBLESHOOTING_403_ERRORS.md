# ๐ง ุฏููู ุญู ูุดุงูู ุฎุทุฃ 403 Forbidden

## ๐จ **ูุง ูู ุฎุทุฃ 403 Forbiddenุ**

ุฎุทุฃ 403 ูุนูู ุฃู ุงูุฎุงุฏู ูููู ุทูุจู ูููู ูุฑูุถ ุชูููุฐู. ูู ูุฐุง ุงููุธุงูุ ุงูุณุจุจ ุงูุฑุฆูุณู ูู ูุดู ูู ุงูู **Authentication** ุฃู **Authorization**.

## ๐ **ุงูุฃุณุจุงุจ ุงูุฑุฆูุณูุฉ:**

### 1๏ธโฃ **ูุดุงูู ุงููุตุงุฏูุฉ (Authentication)**
- ุนุฏู ูุฌูุฏ ุชููู ุตุงูุญ
- ุงูุชูุงุก ุตูุงุญูุฉ ุงูุชููู
- ุชููู ุบูุฑ ุตุญูุญ

### 2๏ธโฃ **ูุดุงูู ุงูุชูููุถ (Authorization)**
- ุงููุณุชุฎุฏู ุบูุฑ ูุดุท (`status โ 1`)
- ุงููุณุชุฎุฏู ุบูุฑ ููุงูู ุนููู (`is_approved โ 1`)

## ๐๏ธ **ุญููู ุงููุดุงูู:**

### **ุงูุญู ุงูุฃูู: ุงูุชุญูู ูู ุญุงูุฉ ุงููุณุชุฎุฏู**

```bash
php scripts/check_user_status.php
```

### **ุงูุญู ุงูุซุงูู: ุฅุตูุงุญ ุญุงูุฉ ุงููุณุชุฎุฏููู**

```bash
php scripts/fix_user_status.php
```

### **ุงูุญู ุงูุซุงูุซ: ุงูุญุตูู ุนูู ุชููู ุฌุฏูุฏ**

```bash
php scripts/get_token.php
```

## ๐ **ุญุงูุงุช ุงููุณุชุฎุฏููู ุงููุทููุจุฉ:**

| ุงูุดุฑุท | ุงููููุฉ ุงููุทููุจุฉ | ุงูู Middleware |
|-------|----------------|----------------|
| `status` | `1` (ูุดุท) | `active` |
| `is_approved` | `1` (ููุงูู ุนููู) | `approved` |

## ๐ **ูุนูููุงุช ุชุณุฌูู ุงูุฏุฎูู ุงูููุญุฏุซุฉ:**

### **ุงููุณุชุฎุฏููู ุงููุดุทูู ุงูุขู:**
- โ **wail** | **ูููุฉ ุงููุฑูุฑ**: `password`
- โ **org_admin** | **ูููุฉ ุงููุฑูุฑ**: `org_admin`
- โ **branch_admin** | **ูููุฉ ุงููุฑูุฑ**: `branch_admin`
- โ **property_admin** | **ูููุฉ ุงููุฑูุฑ**: `property_admin`
- โ **teacher** | **ูููุฉ ุงููุฑูุฑ**: `teacher`
- โ **student** | **ูููุฉ ุงููุฑูุฑ**: `student`

### **ุงููุณุชุฎุฏููู ุงูุขุฎุฑูู:**
- โ **ahmed_teacher** | **ูููุฉ ุงููุฑูุฑ**: `password`
- โ **fatima_teacher** | **ูููุฉ ุงููุฑูุฑ**: `password`
- โ **mohammed_sheikh** | **ูููุฉ ุงููุฑูุฑ**: `password`
- โ **ali_student** | **ูููุฉ ุงููุฑูุฑ**: `password`
- โ **zeinab_student** | **ูููุฉ ุงููุฑูุฑ**: `password`
- โ **hassan_student** | **ูููุฉ ุงููุฑูุฑ**: `password`
- โ **sara_admin** | **ูููุฉ ุงููุฑูุฑ**: `password`
- โ **youssef_admin** | **ูููุฉ ุงููุฑูุฑ**: `password`

## ๐ **ุงููุณุงุฑุงุช ุงููุญููุฉ:**

### **ูุณุงุฑุงุช ุบูุฑ ูุญููุฉ:**
```php
// ูุง ุชุญุชุงุฌ ูุตุงุฏูุฉ
Route::post('login', 'login');
Route::get('refresh', 'refresh');
```

### **ูุณุงุฑุงุช ูุญููุฉ:**
```php
// ุชุญุชุงุฌ ูุตุงุฏูุฉ + ูุดุท + ููุงูู ุนููู
Route::middleware(['auth:api', 'active', 'approved'])->group(function () {
    // ุฌููุน ุงููุณุงุฑุงุช ููุง ูุญููุฉ
    Route::get('admins', 'appGetAllAdmins');
    Route::get('students', 'appGetAllStudents');
    // ... ุจุงูู ุงููุณุงุฑุงุช
});
```

## ๐ **ุฎุทูุงุช ุงูุชุดุฎูุต:**

### **ุงูุฎุทูุฉ 1: ุงูุชุญูู ูู ุงูุชููู**
```bash
# ุงูุญุตูู ุนูู ุชููู ุฌุฏูุฏ
php scripts/get_token.php

# ุงุณุชุฎุฏุงู ุงูุชููู ูู ุงูุทูุจุงุช
curl -H "Authorization: Bearer YOUR_TOKEN" \
     http://127.0.0.1:8000/api/app/v1/admins
```

### **ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู ุญุงูุฉ ุงููุณุชุฎุฏู**
```bash
php scripts/check_user_status.php
```

### **ุงูุฎุทูุฉ 3: ุฅุตูุงุญ ุญุงูุฉ ุงููุณุชุฎุฏููู**
```bash
php scripts/fix_user_status.php
```

### **ุงูุฎุทูุฉ 4: ุงุฎุชุจุงุฑ ุงููุณุงุฑ**
```bash
# ุงุฎุชุจุงุฑ ูุณุงุฑ ูุญูู
curl -H "Authorization: Bearer YOUR_TOKEN" \
     http://127.0.0.1:8000/api/app/v1/admins
```

## ๐จ **ุฑุณุงุฆู ุงูุฎุทุฃ ุงูุดุงุฆุนุฉ:**

| ุฑุณุงูุฉ ุงูุฎุทุฃ | ุงูุณุจุจ | ุงูุญู |
|-------------|-------|------|
| `Your account is inactive.` | `status โ 1` | ุชุดุบูู `fix_user_status.php` |
| `Your account is pending.` | `is_approved โ 1` | ุชุญุฏูุซ `is_approved = 1` |
| `Unauthenticated.` | ุชููู ุบูุฑ ุตุญูุญ/ููุชูู | ุงูุญุตูู ุนูู ุชููู ุฌุฏูุฏ |
| `Too Many Attempts.` | ุชุฌุงูุฒ ุญุฏ ุงูุทูุจุงุช | ุงูุงูุชุธุงุฑ ุฃู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู |

## ๐ก **ูุตุงุฆุญ ูููุฉ:**

1. **ุงุณุชุฎุฏู ุงููุณุชุฎุฏููู ุงููุดุทูู** ููุงุฎุชุจุงุฑ
2. **ุชุญูู ูู ุตุญุฉ ุงูุชููู** ูุจู ูู ุทูุจ
3. **ุงุณุชุฎุฏู `Bearer` ูู Header** ุนูุฏ ุฅุฑุณุงู ุงูุชููู
4. **ุชุญูู ูู ุญุงูุฉ ุงููุณุชุฎุฏู** ุนูุฏ ุญุฏูุซ ุฎุทุฃ 403

## ๐ง **ุฃุฏูุงุช ุงูุชุดุฎูุต:**

- `scripts/check_user_status.php` - ูุญุต ุญุงูุฉ ุงููุณุชุฎุฏููู
- `scripts/fix_user_status.php` - ุฅุตูุงุญ ุญุงูุฉ ุงููุณุชุฎุฏููู
- `scripts/get_token.php` - ุงูุญุตูู ุนูู ุชููู ุฌุฏูุฏ
- `scripts/test_endpoints.php` - ุงุฎุชุจุงุฑ ุงููุณุงุฑุงุช

---

**ุขุฎุฑ ุชุญุฏูุซ**: 2025-10-13  
**ุงููุณุฎุฉ**: 1.0
